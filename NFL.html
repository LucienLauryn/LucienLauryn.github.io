<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Regular Season NFL Standings</title>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style>
path.pats { 
stroke: mediumpurple;
stroke-width: 4px;
}
      
path.pats:hover {
stroke-width: 7px;
stroke: yellow;
	}
	
path,
	line { 
	fill: none;
	stroke: black;
	shape-rendering: crispEdges;
	}
	text {
	font-family: garamond;
		font-size: 13px;
		}
		
	</style>
</head>

<body>

<div id ="chart"></div>
<script type = "text/javascript">

	var w = 800;
	var h = 600;
	var margin = 50;
	var teamcol = 200;

	var weeks = 16;
	var wins = 16;
	var teams = 32;
	var seq = function(x) {
		for (i = 0; i <= x; i++) { list.push(i); }
		return list
		}

	svg = d3.select("#chart")
			.append("svg")
			.attr("width",w)
			.attr("height",h);


	//Scale dimensions
	var xScale = d3.scale.linear()
					.domain([0,weeks])
					.range([0,w-margin-teamcol]);
	var yScale = d3.scale.linear()
					.domain([0,wins])
					.range([h-margin,margin]);

	//axis dimensions
	var xAxis = d3.svg.axis()
					.scale(xScale)
					.orient("bottom")
					.ticks(weeks);

	var yAxis = d3.svg.axis()
					.scale(yScale)
					.orient("left")
					.ticks(wins);
	

	//Drawing the Axis
				svg.append("g")
					.attr("class","yaxis")
					.attr("transform","translate(" + (margin/2+teamcol) + "," + 0 + ")")
					.call(yAxis);
					
				svg.append("g")
					.attr("class","xaxis")
					.attr("transform","translate("+ (margin/2+teamcol) +","+(h-margin)+")")
					.call(xAxis);

	//Drawing Gridlines
				svg.append("g")
					.attr("class","line")
				    .selectAll(".h")
					.data(d3.range(0,teams))
					.enter()
					.append("line")
					.attr("class","h")
					.attr("x1", 0).attr("x2", teamcol)
					.attr("y1",yScale).attr("y2", yScale)
					.attr("transform","translate(0,"+margin+")")

			/*	svg.selectAll(".v")
					.data(d3.range(0,16))
					.enter()
					.append("line")
					.attr("class","v")
					.attr("x1", xScale).attr("x2", xScale)
					.attr("y1", margin).attr("y2", h-margin);*/


//Loading data and generating vis	
d3.csv("compiled.csv", function(d) {
  
  var dataset=d3.nest()
  .key(function(d) {return d.conference;})
  .key(function(d) {return d.division;})
  /*.rollup(function(leaves) { return leaves.length; })*/
  .entries(d);


			svg.append("rect")
			 .attr("x", Math.random()*500)
			 .attr("y",Math.random()*500)
			 .attr("width",20)
			 .attr("height",40)
			 .attr("fill","purple");

  			console.log(dataset)

  		var g = svg.append("g").attr("class","dataset")
	  			.selectAll("g.data")
	  			.data(dataset)
	  			.enter()
	  			.append("g")
	  			.attr("class","data")
	  			.attr("transform",function(d,i) { return "translate(0,"+(margin+i*240)+")";})

	  		g.selectAll("g.team")
	  		 .data(function(d) { return d.values;})
	  		 .enter() 
			 .append("g")
		 	 .attr("class","team")
		 	 .append("text")
			 .attr("x", margin)
			 .attr("y", function(d,i) { return (i*15);})
			 .text(function(d,i) { 
			 	console.log(d)
			 	return d.team;});

			 g.selectAll("g.wins")
	  		 .data(function(d) { return d.values;})
	  		 .enter() 
			 .append("g")
		 	 .attr("class","wins")
		 	 .append("lines")
			 .attr("x", margin/2+teamcol)
			 .attr("y", function(d,i) { return (i*15);})
			 .attr("(function(d,i) { 
			 	console.log(d)
			 	return d.wins;});

	})


</script>
</body>
</html>